# 测试程序使用说明

## 🎯 新版测试程序特点

已更新为使用**统一智能接口** `FilePropertyEditor.ShowEditor()`，无需手动判断文件/文件夹类型！

## 📖 使用方式

### 方式1: 不带参数运行（使用默认测试路径）

直接双击运行 `写入文件备注.exe`，程序会：

1. 自动在运行目录创建测试文件和文件夹：
   - `test_file.txt` - 单个测试文件
   - `batch_test_1.txt` - 批量测试文件1
   - `batch_test_2.txt` - 批量测试文件2
   - `test_folder\` - 测试文件夹

2. 验证这些路径是否存在

3. 自动打开合适的编辑器（批量编辑器，因为有多个路径）

**运行效果示例：**
```
=== 文件和文件夹备注测试程序（统一接口版本） ===

--- 使用统一智能接口 FilePropertyEditor.ShowEditor() ---

⚠️  未提供命令行参数，使用默认测试路径列表

提示：你可以这样使用：
  单个文件:   程序.exe "C:\test\file.txt"
  单个文件夹: 程序.exe "C:\test\folder"
  批量操作:   程序.exe "C:\file1.txt" "C:\file2.txt" "C:\folder1"

正在使用默认测试路径...

📁 准备测试环境...
  ✓ 已创建测试文件: D:\...\test_file.txt
  ✓ 已创建批量测试文件: D:\...\batch_test_1.txt
  ✓ 已创建批量测试文件: D:\...\batch_test_2.txt
  ✓ 已创建测试文件夹: D:\...\test_folder

🔍 验证路径有效性...
  ✓ 文件: D:\...\test_file.txt
  ✓ 文件: D:\...\batch_test_1.txt
  ✓ 文件: D:\...\batch_test_2.txt
  ✓ 文件夹: D:\...\test_folder

验证结果: 4 个有效, 0 个无效

🚀 正在打开编辑器...

[打开批量编辑器窗口]
```

### 方式2: 带参数运行（命令行测试）

#### 测试单个文件：
```bash
写入文件备注.exe "C:\test\myfile.txt"
```
→ 自动打开**文件属性编辑器**

#### 测试单个文件夹：
```bash
写入文件备注.exe "C:\test\myfolder"
```
→ 自动打开**文件夹属性编辑器**

#### 测试批量操作：
```bash
写入文件备注.exe "C:\file1.txt" "C:\file2.txt" "C:\folder1"
```
→ 自动打开**批量编辑器**

## 🔧 自定义测试路径

如果默认路径不符合你的需求，请修改 `Program.cs` 中的 `GetDefaultTestPaths()` 方法：

```csharp
static List<string> GetDefaultTestPaths()
{
    var paths = new List<string>
    {
        // 添加你自己的测试路径
        @"D:\我的文档\测试文件.txt",
        @"D:\我的文档\测试文件夹",
        // ...更多路径
    };
    
    return paths;
}
```

## ⚠️ 错误处理

### 如果所有路径都无效

程序会显示：
```
❌ 错误：所有路径都无效！

请执行以下操作之一：
  1. 修改程序中的 GetDefaultTestPaths() 方法，设置正确的测试路径
  2. 使用命令行参数传入有效的文件或文件夹路径

程序已停止。
```

**解决方法：**
- 修改 `GetDefaultTestPaths()` 方法中的路径
- 或者使用命令行参数传入有效路径

## 📊 返回结果说明

| 显示信息 | 含义 |
|---------|------|
| `✓ 属性已成功保存！` | 用户点击保存，成功保存 |
| `ℹ️  用户取消了操作` | 用户点击取消或关闭窗口 |
| `⚠️  请提供有效的文件或文件夹路径` | 输入为空 |
| `⚠️  没有找到有效的文件或文件夹` | 所有路径都不存在 |
| `❌ 错误：...` | 发生异常错误 |

## 🎨 界面说明

根据传入的路径，程序会自动打开对应的编辑器：

### 单文件编辑器
- **显示内容：** 文件完整路径
- **可编辑字段：** 标题、主题、分级、标记、类别、备注
- **特点：** 支持字段自定义显示/隐藏和排序

### 单文件夹编辑器
- **显示内容：** 文件夹完整路径
- **可编辑字段：** 别名、备注、标题、主题、作者、标记
- **特点：** 支持字段自定义显示/隐藏和排序

### 批量编辑器
- **显示内容：** 操作目录（智能计算共同父目录）
- **支持：** 同时编辑多个文件和文件夹
- **功能：** 
  - 全选/全不选/反选
  - 批量赋值
  - 批量清空
  - 选择性保存
  - 导入/导出配置（TOML格式）

## 🚀 优势

### 新版 vs 旧版

| 特性 | 旧版（已注释） | 新版（当前） |
|------|--------------|------------|
| 调用方式 | 需要3个独立方法 | 只需1个统一方法 |
| 类型判断 | 手动判断 | 自动判断 |
| 代码行数 | 约150行 | 约60行 |
| 参数支持 | 不支持 | 支持命令行参数 |
| 路径验证 | 无 | 自动验证并提示 |
| 错误处理 | 简单 | 完善 |

### 代码对比

**旧版写法：**
```csharp
// 需要三个独立方法
TestFileRemark();
TestBatchFileRemark();
TestFolderRemark();

// 每个方法都要重复写一堆判断和创建逻辑
```

**新版写法：**
```csharp
// 一个方法搞定一切
TestUnifiedEditor(args);

// 内部自动调用统一接口
FilePropertyEditor.ShowEditor(testPaths);
```

## 📝 旧版测试方法

旧版的三个测试方法已被注释，但仍保留在代码中供参考：
- `TestFileRemark()` - 测试文件备注
- `TestFolderRemark()` - 测试文件夹备注
- `TestBatchFileRemark()` - 测试批量备注

如需使用旧版，请取消注释并在 `Main()` 方法中调用。

## 💡 提示

1. **首次运行** - 程序会自动创建测试文件和文件夹，无需手动准备
2. **路径验证** - 程序会先验证所有路径，无效路径会被标记
3. **智能选择** - 根据路径数量和类型，自动选择最合适的编辑器
4. **命令行支持** - 可以从命令行传入任意路径进行测试

## 🎯 快速开始

1. 直接双击运行 `写入文件备注.exe`
2. 程序自动创建测试环境
3. 打开批量编辑器
4. 编辑属性并保存
5. 完成！

就是这么简单！🎉


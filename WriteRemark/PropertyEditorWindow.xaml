<Window x:Class="WriteRemark.PropertyEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WriteRemark"
        mc:Ignorable="d"
        Title="编辑文件属性" Height="450" Width="480"
        MinHeight="300" MinWidth="400"
        WindowStartupLocation="CenterScreen"
        SizeToContent="Height"
        TextOptions.TextFormattingMode="Display"
        TextOptions.TextRenderingMode="ClearType"
        UseLayoutRounding="True"
        SnapsToDevicePixels="True"
        Loaded="Window_Loaded">
    <Window.Resources>
        <!-- 现代化按钮样式 -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="#FF4CAF50"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="4" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF45A049"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FF3D8B40"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- 取消按钮样式 -->
        <Style x:Key="CancelButton" TargetType="Button">
            <Setter Property="Background" Value="#FFE0E0E0"/>
            <Setter Property="Foreground" Value="#FF333333"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#FF888888"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="4" 
                                Padding="{TemplateBinding Padding}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FFD0D0D0"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FFC0C0C0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 设置按钮样式 -->
        <Style x:Key="SettingsButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="#FF888888"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="15" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FFF3F3F3"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FFE0E0E0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 文本框样式 -->
        <Style TargetType="TextBox">
            <Setter Property="BorderBrush" Value="#FFCCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="3">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                          Padding="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="#FF2196F3"/>
                                <Setter Property="BorderThickness" Value="2"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    
    <Grid Margin="20" Background="#FAFAFA">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- 标题栏和设置按钮 -->
        <Border Grid.Row="0" Margin="0,0,0,15" Background="White" CornerRadius="8" Padding="15,8">
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="2" Color="LightGray" Opacity="0.3"/>
            </Border.Effect>
            <StackPanel>
                <!-- 标题行 -->
                <Grid>
                    <TextBlock Text="文件备注" FontSize="18" 
                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="#FF333333" />
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                        <Button x:Name="btnTopMost" Width="22" Height="22" Click="BtnTopMost_Click" 
                                ToolTip="窗口已置顶（点击取消）" Background="Transparent" BorderThickness="0" Margin="0,0,8,0"
                                Cursor="Hand" Padding="2">
                            <Path x:Name="pathTopMost" Data="M7,15L12,10L17,15H7Z" 
                                  Fill="#FF4CAF50" Stretch="Uniform" Width="12" Height="12" />
                        </Button>
                        <Button x:Name="btnSettings" Width="22" Height="22" Click="BtnSettings_Click"
                                ToolTip="字段设置" Background="Transparent" BorderThickness="0"
                                Cursor="Hand" Padding="2">
                            <Path Data="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"
                                  Fill="#FF888888" Stretch="Uniform" Width="12" Height="12" />
                        </Button>
                    </StackPanel>
                </Grid>
                
                <!-- 文件路径显示 -->
                <Border Margin="0,8,0,0" Background="#FFF5F5F5" CornerRadius="4" Padding="8,5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0" Text="文件路径：" FontSize="11" Foreground="#FF666666" 
                                   Margin="0,0,0,3"/>
                        <TextBox Grid.Row="1" x:Name="txtFilePath" IsReadOnly="True" 
                                 Background="Transparent" BorderThickness="0" 
                                 FontSize="11" Foreground="#FF333333" 
                                 Padding="0" MinHeight="20" MaxHeight="60"
                                 TextWrapping="Wrap" 
                                 VerticalScrollBarVisibility="Auto"
                                 IsTabStop="False"
                                 ToolTip="{Binding Text, RelativeSource={RelativeSource Self}}"/>
                    </Grid>
                </Border>
            </StackPanel>
        </Border>

        <!-- 动态字段区域 -->
        <Border Grid.Row="1" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10">
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="2" Color="LightGray" Opacity="0.3"/>
            </Border.Effect>
            <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="400">
                <StackPanel x:Name="FieldsPanel" />
            </ScrollViewer>
        </Border>

        <!-- 已隐藏字段区域 -->
        <Expander Grid.Row="2" x:Name="HiddenFieldsExpander" Header="已隐藏的字段" 
                  Margin="0,0,0,10" IsExpanded="False" Background="White">
            <Border Background="#FFF8F8F8" CornerRadius="5" Padding="10" Margin="0,5,0,0">
                <StackPanel x:Name="HiddenFieldsPanel" />
            </Border>
        </Expander>

        <!-- 按钮区域 -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">

            <Button x:Name="btnSave" Content="保存" Width="80" Click="BtnSave_Click" Margin="15,0,0,0"
                    IsDefault="True" Style="{StaticResource ModernButton}" />
            <Button x:Name="btnCancel" Content="取消" Width="80" Margin="15,0,0,0" 
                    IsCancel="True" Style="{StaticResource CancelButton}" />
        </StackPanel>
    </Grid>
</Window>

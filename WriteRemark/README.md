# WriteRemark - 文件属性编辑器

## 功能概述

WriteRemark是一个用于编辑Windows文件属性的工具，支持编辑文件的标题、主题、分级、标记、类别和备注等属性。

## 新功能特性

### 1. 动态字段配置
- 自动在DLL旁边生成`field_config.json`配置文件
- 记录每个字段的显示名称、可见性、顺序和提示信息
- 支持字段的个性化配置

### 2. 可视化字段管理
- 点击右上角的设置按钮（扳手图标）进入编辑模式
- 在编辑模式下可以：
  - 通过拖拽手柄（⋮⋮）重新排序字段
  - 点击关闭按钮（×）隐藏不需要的字段
  - 在下方"已隐藏的字段"区域恢复显示字段

### 3. 用户友好的界面
- 清晰的字段分组显示
- 可折叠的隐藏字段区域
- 直观的拖拽操作体验

## 使用方法

### 基本使用
```csharp
// 显示文件属性编辑器
bool result = FilePropertyEditor.ShowPropertyEditor(@"C:\path\to\your\file.txt");
```

### 字段管理
1. **进入设置模式**：点击界面右上角的设置按钮
2. **重新排序**：在设置模式下，拖拽字段左侧的手柄来调整顺序
3. **隐藏字段**：点击字段右侧的×按钮隐藏不需要的字段
4. **恢复字段**：在"已隐藏的字段"区域点击+按钮恢复显示
5. **退出设置**：再次点击设置按钮退出设置模式

### 配置文件
程序会在DLL同目录下自动创建`field_config.json`文件，包含以下信息：
```json
[
  {
    "FieldName": "Title",
    "DisplayName": "标题",
    "IsVisible": true,
    "Order": 1,
    "ToolTip": "文件标题"
  },
  // ... 其他字段配置
]
```

## 技术特性

- **框架**：.NET Framework 4.8 + WPF
- **依赖**：Microsoft WindowsAPICodePack、Newtonsoft.Json
- **拖拽支持**：完整的拖放功能实现
- **配置持久化**：JSON格式的配置文件存储

## 编译和运行

1. 确保安装了.NET Framework 4.8
2. 使用Visual Studio或MSBuild编译项目
3. 运行TestProgram.exe进行功能测试

## 注意事项

- 配置文件会自动创建，无需手动配置
- 支持的文件类型取决于Windows Shell属性系统
- 拖拽功能仅在设置模式下可用
- 字段顺序和可见性设置会自动保存

## 更新日志

### v2.0
- ✨ 新增动态字段配置功能
- ✨ 新增可视化字段管理界面
- ✨ 新增拖拽排序功能
- ✨ 新增字段隐藏/显示功能
- 🔧 优化用户界面体验
- 📝 完善文档说明
